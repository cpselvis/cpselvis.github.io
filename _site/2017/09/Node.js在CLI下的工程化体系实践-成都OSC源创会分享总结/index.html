<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结</title>
  <meta name="description" content="  背景: 随着开发团队规模不断发展壮大，在人员增加的同时也带来了协作成本的增加，业务项目越来越多，类型也各不相同。常见的类型有组件类、活动类、基于React+redux的业务项目、RN项目、Node.js项目等等。如果想要对每个项目进行一些规范的约束比如Git提交规范、Javascript规范简直难于登天。所有...">
  <meta name="author" content="Wei Wang">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结">
  <meta name="twitter:description" content="  背景: 随着开发团队规模不断发展壮大，在人员增加的同时也带来了协作成本的增加，业务项目越来越多，类型也各不相同。常见的类型有组件类、活动类、基于React+redux的业务项目、RN项目、Node.js项目等等。如果想要对每个项目进行一些规范的约束比如Git提交规范、Javascript规范简直难于登天。所有...">
  
  <meta property="og:type" content="article">
  <meta property="og:title" content="《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结">
  <meta property="og:description" content="  背景: 随着开发团队规模不断发展壮大，在人员增加的同时也带来了协作成本的增加，业务项目越来越多，类型也各不相同。常见的类型有组件类、活动类、基于React+redux的业务项目、RN项目、Node.js项目等等。如果想要对每个项目进行一些规范的约束比如Git提交规范、Javascript规范简直难于登天。所有...">
  
  <link rel="icon" type="image/png" href="/assets/images/favicon.png" />
  <link href="/assets/images/favicon.png" rel="shortcut icon" type="image/png">
  
  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="http://localhost:4000/2017/09/Node.js%E5%9C%A8CLI%E4%B8%8B%E7%9A%84%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%BD%93%E7%B3%BB%E5%AE%9E%E8%B7%B5-%E6%88%90%E9%83%BDOSC%E6%BA%90%E5%88%9B%E4%BC%9A%E5%88%86%E4%BA%AB%E6%80%BB%E7%BB%93/">
  <link rel="alternate" type="application/rss+xml" title="cpselvis" href="http://localhost:4000/feed.xml">
  
  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />
  
</head>


  <body>

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    
    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/assets/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/#blog" title="前往 cpselvis 的主页" class="blog-button"><img src="/assets/images/avatar.jpg" width="80" alt="cpselvis logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for cpselvis" class="blog-button">cpselvis</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">落花无言,人淡如菊,心素如简</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">嗨，我是程柳锋 (@cpselvis)，一名来自中国的 web 开发者。现居深圳，就职于 腾讯。目前负责研发规范和工程化建设，曾在OSC源创会上做过分享。</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        
        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="Visit blog" class="blog-button">博客</a></li>
                
                  <li class="navigation__item"><a href="https://cpselvis.github.io/" target="_blank" title="My Projects">首页</a></li>
                
              </ul>
            </nav>
          </div>
          
          <div><nav class="cover-navigation navigation--social">
  <ul class="navigation">

  
  <!-- Weibo -->
  <li class="navigation__item">
    <a href="http://weibo.com/cpselvis" title="@cpselvis 的微博" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li>
  

  
  <!-- Github -->
  <li class="navigation__item">
    <a href="https://github.com/cpselvis" title="@cpselvis 的 Github" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>
  
  
  
  <!-- Twitter -->
  <li class="navigation__item">
    <a href="http://twitter.com/cpselvis" title="@cpselvis" target="_blank">
      <i class='social fa fa-twitter'></i>
      <span class="label">Twitter</span>
    </a>
  </li>
  

  
  <!-- Google Plus -->
  <li class="navigation__item">
    <a href="https://plus.google.com/104634663101299635957" rel="author" title="Google+" target="_blank">
      <i class='social fa fa-google-plus-square'></i>
      <span class="label">Google Plus</span>
    </a>
  </li>
  

  <!-- RSS -->
  <li class="navigation__item">
    <a href="/feed.xml" rel="author" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>

  
  <!-- Email -->
  <li class="navigation__item">
    <a href="mailto:cpselvis@gmail.com" title="Contact me">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>
  

  </ul>
</nav>
</div>
        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-blue"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2017-09-26 15:18:24 +0800" itemprop="datePublished" class="post-meta__date date">2017-09-26</time> &#8226; <span class="post-meta__tags tags"></span>
    </div>
    <h1 class="post-title">《Node.js在CLI下的工程化体系实践》成都OSC源创会分享总结</h1>
  </header>

  <section class="post">
    <blockquote>
  <p>背景: 随着开发团队规模不断发展壮大，在人员增加的同时也带来了协作成本的增加，业务项目越来越多，类型也各不相同。常见的类型有组件类、活动类、基于React+redux的业务项目、RN项目、Node.js项目等等。如果想要对每个项目进行一些规范的约束比如Git提交规范、Javascript规范简直难于登天。所有的这些，只因为缺少一个好用的工程化工具。从项目创建、开发、构建、代码规范检查到最终项目上线，通过CLI可以提升效率，同时保障开发规范的实施。</p>
</blockquote>

<h3 id="nodejs实现cli的基本原理">Node.js实现CLI的基本原理</h3>
<p>关键点在于package.json里面的bin字段。模块全局安装，对于类unix系统，在/usr/local/bin目录创建软链接；对于windows系统，在C:\Users\username\AppData\Roaming\npm目录创建软链接。
模块局部安装，会在项目内的./node_modules/.bin目录创建软链接。</p>

<h3 id="现代化web工程的生命周期">现代化web工程的生命周期</h3>
<p>随着前端工程的不断演进，一方面工程变得日趋复杂，同时对规范和质量的诉求在不断增加。现代化web工程应该包含以下几个阶段：初始化、开发、构建、检查、发布。如下图所示：</p>

<p><img src="http://7tszky.com1.z0.glb.clouddn.com/FlNAEJ0ntRgo-NxeHVtTUc6P8lvz" alt="" /></p>

<h3 id="痛点1项目拷贝">痛点1：项目拷贝</h3>
<p>项目拷贝存在的问题显而易见，大致有以下三个方面：</p>
<ul>
  <li>容易出错；一旦某个关键文件拷贝丢失或者错误，很可能需要耗费半天到一天的时间排查环境问题。</li>
  <li>不同场景下对目录结构要求不同；平时开发过程中，工程通常会分为运营活动、Hybrid业务、入口级别的项目（对性能和体验有极致和苛刻的要求）。需要基于RN或者Node.js的首屏直出，还有常用的业务组件等的开发。</li>
  <li>新的Feature和BugFix难以同步；某个同学开发过程中增加的新方法或者解决的bug很难传递给其它同学并且沉淀成经验积累下来。</li>
</ul>

<p>社区里面提供了完美的Yeoman解决方案，它是为了自动化项目的创建而生。Yeoman创建项目包括以下几个阶段：</p>
<ul>
  <li>initializing:  初始化一些状态之类的，通常是和用户输入的 options 或者 arguments 打交道</li>
  <li>prompting: 和用户交互的时候（命令行问答之类的）调用</li>
  <li>configuring: 保存配置文件（如 .babelrc 等）</li>
  <li>writing: 生成模板文件</li>
  <li>install: 安装依赖</li>
  <li>end:  结束部分，初始代码自动提交</li>
</ul>

<p>我们只需要继承Yeoman的Generator类做模板定制化，基于Yeoman的脚手架设计思路应该如下图所示：
<img src="https://pub.idqqimg.com/pc/misc/files/20170921/618294e985fc44989ec5087118ceeb63.jpg" alt="" /></p>

<p>首先，开发者会和CLI进行交互，开发者会告诉CLI需要创建哪一种类型的项目，CLI收到命令后。从本地已经安装的Yeoman脚手架里面选择某种类型的模板。然后，CLI会调用Gitlab API在远程创建仓库并且授予开发者master权限。接下来，会根据实际业务场景需要，自动化申请一些打点信息，常见的如离线包id，监控告警id等等。之后，在本地目录生成代码并且安装项目依赖的npm包，最后将本次初始化生成的所有代码自动提交到远程Git仓库。</p>

<h3 id="痛点2运营配置频繁修改">痛点2：运营配置频繁修改</h3>
<p>基于React+redux组件化开发方式中，一个页面或者webapp是由多个容器组件拼装后渲染而成。
<img src="http://7tszky.com1.z0.glb.clouddn.com/Fps7Ta8l5HhrH4vWynaM5FyPra9q" alt="" /></p>

<p>某个组件通常是由：模板、cgi数据和事件组成。理想情况下，开发和产品和平共处，你可以把一个组件写成下面这个样子，比如规则组件：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>render() {
	return (
    	&lt;div className="lottery-rule"&gt;
        	&lt;div className="section"&gt;
            	&lt;h3&gt;活动时间：&lt;/h3&gt;
                &lt;p&gt;9月14日～9月30日&lt;/p&gt;
            &lt;/div&gt;
            &lt;div className="section"&gt;
            	&lt;h3&gt;活动规则：&lt;/h3&gt;
            	&lt;p&gt;1、活动期间，在NOW app上录制小视频，上传成功后即可参赛。&lt;/p&gt;
                &lt;p&gt;2、根据参赛小视频获得的点赞数进行排行。&lt;/p&gt;
                &lt;p&gt;3、按照城市评选，分别评选“明日之子”（仅限男性参加）和”闪亮女神“仅限女性参加。&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    );
}
</code></pre>
</div>
<p>咋一看，上面的写法没什么问题。实际确很可能是7、8次的文案修改，甚至对外入口开放后仍然要修改文案或者图片等静态数据。然后，你需要走代码发布流程。</p>

<p>更好的解决思路是：在开发某个业务组件之前，结合以往的经验，分析哪些静态数据很可能是需要高频次的修改。将这些高频次修改的静态数据抽离出来，对于万年不变的数据则没有必要抽出来。那么，如何将静态数据动态化呢？</p>

<p>答案是： ** Schema First **， 开发组件之前先设计Schema，通过schema生成一个form表单，达到静态数据和模板分离。如果使用React开发，可以基于<a href="https://github.com/mozilla-services/react-jsonschema-form">react-jsonschema-form</a>定制。静态数据和模板分离之后应该如下图：</p>

<p><img src="http://7tszky.com1.z0.glb.clouddn.com/FoHcVP9tsMFW-7_AKol20XWBsBcq" alt="" /></p>

<h3 id="痛点3缺少协作规范">痛点3：缺少协作规范</h3>
<p>此处以Git commit规范为例子进行相关改进介绍。</p>

<p>良好的Git commit规范有以下优势：</p>
<ul>
  <li>加快Review的流程</li>
  <li>根据Commit元数据生成Changelog</li>
  <li>后续维护者可以知道feature被添加的原因</li>
</ul>

<p>此处采用Google angular项目的提交作为参考，整理出Git commit的解决方案：
<img src="http://images2015.cnblogs.com/blog/1030776/201703/1030776-20170304152156235-891182085.png" alt="" /></p>

<p>具体的提交格式要求如下：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;
&lt;BLANK LINE&gt;
&lt;body&gt;
&lt;BLANK LINE&gt;
&lt;footer&gt;
</code></pre>
</div>

<p>对格式的说明如下：</p>

<ul>
  <li>type代表某次提交的类型，比如是修复一个bug还是增加一个新的feature。所有的type类型如下：</li>
  <li>feat： 新增feature</li>
  <li>fix: 修复bug</li>
  <li>docs: 仅仅修改了文档，比如README, CHANGELOG, CONTRIBUTE等等</li>
  <li>style: 仅仅修改了空格、格式缩进、都好等等，不改变代码逻辑</li>
  <li>refactor: 代码重构，没有加新功能或者修复bug</li>
  <li>perf: 优化相关，比如提升性能、体验</li>
  <li>test: 测试用例，包括单元测试、集成测试等</li>
  <li>chore: 改变构建流程、或者增加依赖库、工具等</li>
  <li>revert: 回滚到上一个版本</li>
</ul>

<p>一键生成Changelog版本日志：
<img src="http://7tszky.com1.z0.glb.clouddn.com/Fu-kJyozpfuJ6LFTW6IlXoOmRiLh" alt="" /></p>

<h3 id="痛点4-缺少代码规范">痛点4: 缺少代码规范</h3>
<p>一次血淋淋的生产环境事故：2017年4月13日，腾讯高级工程师小圣在做充值业务时，修改了苹果iap支付配置，将JSON配置增加了重复的key。代码发布后，有小部分使用了vivo手机的用户反馈充值页面白屏，无法在Now app内进行充值。最后问题定位是：vivo手机使用了系统自带的webview而没有使用X5内核，解析JSON时遇到重复key报错，导致页面白屏。</p>

<p>分析：现代化的浏览器对于JSON里面的重复key会做兼容处理，但是某些老旧的浏览器内核并不会，比如此处的vivo手机，导致代码直接出错。那么，如何避免类似问题再次出现呢？</p>

<p>此处不得不提及ESLint，ESLint于2013年6月推出最新版本v4.6.0，是一款适用于Javascript和JSX的代码规范检查工具，相比JSLint和JSHint而言，它更加灵活，支持自定义配置、插件扩展和配置错误级别。虽然接入ESLint会给团队的同学增加不少代码修改的成本，但是从长远来看，收益肯定是大于付出的。</p>

<p>Javascript规范制定的原则：</p>
<ul>
  <li>不重复造轮子，基于eslint:recommend 配置并改进</li>
  <li>能够帮助发现代码错误的规则，全部开启</li>
  <li>配置不应该依赖于某个具体项目，而应尽可能的合理</li>
  <li>帮助保持团队的代码风格统一，而不是限制开发体验</li>
  <li>有对应的解释文档</li>
</ul>

<p>为了更好的定制和维护Javascript规范，我们创建了eslint的<a href="https://github.com/iv-web/eslint-config-ivweb">shareable config</a>。一方面，我们觉得eslint:recommend 里面的部分配置定义的错误级别过于严格，比如代码里面出现了console会导致校验错误，另一方面，它没有包含ESLint的最佳实践和其它规则。我们定义的部分规则解释如下：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">规则名称</th>
      <th style="text-align: left">错误级别</th>
      <th style="text-align: left">说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/for-direction">for-direction</a></td>
      <td style="text-align: left">error</td>
      <td style="text-align: left">for 循环的方向要求必须正确</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/getter-return">getter-return</a></td>
      <td style="text-align: left">error</td>
      <td style="text-align: left">getter必须有返回值，并且禁止返回值为undefined, 比如 return;</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/no-await-in-loop">no-await-in-loop</a></td>
      <td style="text-align: left">off</td>
      <td style="text-align: left">允许在循环里面使用await</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/no-console">no-console</a></td>
      <td style="text-align: left">off</td>
      <td style="text-align: left">允许在代码里面使用console</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/no-prototype-builtins">no-prototype-builtins</a></td>
      <td style="text-align: left">warn</td>
      <td style="text-align: left">直接调用对象原型链上的方法</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/valid-jsdoc">valid-jsdoc</a></td>
      <td style="text-align: left">off</td>
      <td style="text-align: left">函数注释一定要遵守jsdoc规则</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/no-template-curly-in-string">no-template-curly-in-string</a></td>
      <td style="text-align: left">warn</td>
      <td style="text-align: left">在字符串里面出现{和}进行警告</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/accessor-pairs">accessor-pairs</a></td>
      <td style="text-align: left">warn</td>
      <td style="text-align: left">getter和setter没有成对出现时给出警告</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/array-callback-return">array-callback-return</a></td>
      <td style="text-align: left">error</td>
      <td style="text-align: left">对于数据相关操作函数比如reduce, map, filter等，callback必须有return</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/block-scoped-var">block-scoped-var</a></td>
      <td style="text-align: left">error</td>
      <td style="text-align: left">把var关键字看成块级作用域，防止变量提升导致的bug</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/class-methods-use-this">class-methods-use-this</a></td>
      <td style="text-align: left">error</td>
      <td style="text-align: left">要求在Class里面合理使用this，如果某个方法没有使用this,则应该申明为静态方法</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/complexity">complexity</a></td>
      <td style="text-align: left">off</td>
      <td style="text-align: left">关闭代码复杂度限制</td>
    </tr>
    <tr>
      <td style="text-align: left"><a href="https://eslint.org/docs/rules/default-case">default-case</a></td>
      <td style="text-align: left">error</td>
      <td style="text-align: left">switch case语句里面一定需要default分支</td>
    </tr>
  </tbody>
</table>

<p>ESLint的执行可以接入到PUSH hook里面，步骤如下：</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#1, 安装husky</span>
<span class="gp">$ </span>npm install husky --save-dev

<span class="c">#2, 集成进npm script</span>
<span class="o">{</span>
  <span class="s2">"scripts"</span>: <span class="o">{</span>
    <span class="s2">"precommit"</span>: <span class="s2">"validate-commit-msg"</span>,
    <span class="s2">"prepush"</span>: <span class="s2">"eslint src ./.eslintrc.js --ext '.js,.jsx'"</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="cli设计">CLI设计</h3>
<p>CLI的作用是将工程开发过程中遇到的一系列痛点问题连接起来，提升开发效率，同时保障规范的实施。</p>

<p><img src="https://pub.idqqimg.com/pc/misc/files/20170921/f81f93c5be874ed1b7c90b7fbb56ce87.jpg" alt="" /></p>

<h3 id="插件设计">插件设计</h3>
<h4 id="插件实现原理">插件实现原理</h4>
<p>这里有一个非常巧妙的设计，通过使用node提供的module和vm模块，可以通注入feflow全局变量来访问到cli的实例。从而能够访问cli上的各种属性，比如config, log和一些helper等。</p>
<div class="highlighter-rouge"><pre class="highlight"><code> loadPlugin(path, callback) {
    const self = this;

    return fs.readFile(path).then((script) =&gt; {

      const module = new Module(path);
      module.filename = path;
      module.paths = Module._nodeModulePaths(path);

      function require(path) {
          return module.require(path);
      }

      require.resolve = function(request) {
          return Module._resolveFilename(request, module);
      };

      require.main = process.mainModule;
      require.extensions = Module._extensions;
      require.cache = Module._cache;

      // Inject feflow variable
      script = '(function(exports, require, module, __filename, __dirname, feflow){' +
          script + '});';

      const fn = vm.runInThisContext(script, path);

      return fn(module.exports, require, module, path, pathFn.dirname(path), self);
      }).asCallback(callback);
  }
</code></pre>
</div>

<h4 id="命令注册">命令注册：</h4>

<p>命令需要以feflow.cmd.register进行注册，比如：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>feflow.cmd.register('deps', 'Config ivweb dependencies', function(args) {
    console.log(args);
    // Plugin logic here.
});
</code></pre>
</div>

<p>说明：</p>
<ul>
  <li>register有3个参数，第一个是子命令名称，第二个是命令描述说明信息，第三个是对应的子命令执行逻辑函数。</li>
  <li>feflow会将命令行参数args解析成Object对象，传递给插件处理函数</li>
</ul>

<h4 id="配置">配置</h4>
<p>可以通过feflow.version获取当前feflow的版本，feflow.baseDir 获取feflow跟目录（在用户目录下的.feflow），通过feflow.pluginDir 获取插件目录</p>

<h4 id="日志">日志</h4>
<p>通过feflow.log来进行相关命令行日志输出</p>

<div class="highlighter-rouge"><pre class="highlight"><code>const log = feflow.log;
log.info()    // 提示日志，控制台中显示绿色
log.debug()   // 调试日志,  命令行增加--debug可以开启，控制台中显示灰色
log.warn()    // 警告日志，控制台中显示黄色背景
log.error()   // 错误日志，控制台中显示红色
log.fatal()   // 致命错误日志，，控制台中显示红色
</code></pre>
</div>

<h3 id="最后">最后</h3>
<p>感谢OSC源创汇提供的交流机会，能和广大开发者分享和交流学习。NOW直播IVWEB团队的工程化解决方案如下：</p>
<ul>
  <li>Github主页：https://github.com/cpselvis/feflow-cli</li>
  <li>码云主页：https://gitee.com/cpselvis/feflow-cli</li>
</ul>

<p>附件：<a href="https://github.com/cpselvis/sharing/blob/master/ppt/%E6%88%90%E9%83%BDOSC%E5%88%86%E4%BA%AB2017-09-23/Node.js%E5%9C%A8CLI%E4%B8%8B%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%BD%93%E7%B3%BB%E5%AE%9E%E8%B7%B5.pdf">本次分享PPT</a></p>

  </section>
</article>

<section class="read-more">
   
   
   
   
   <div class="read-more-item">
       <span class="read-more-item-dim">更早的文章</span>
       <h2 class="post-list__post-title post-title"><a href="/2017/06/python%E7%BC%96%E5%86%99%E7%9F%A5%E4%B9%8E%E7%88%AC%E8%99%AB%E5%AE%9E%E8%B7%B5/" title="link to python编写知乎爬虫实践">python编写知乎爬虫实践</a></h2>
       <p class="excerpt">爬虫的基本流程网络爬虫的基本工作流程如下：  首先选取一部分精心挑选的种子URL  将种子URL加入任务队列  从待抓取URL队列中取出待抓取的URL，解析DNS，并且得到主机的ip，并将URL对应的网页下载下来，存储进已下载网页库中。此外，将这些URL放进已抓取URL队列。  分析已抓取URL队列中的URL，分析其中的其他URL，并且将URL放入待抓取URL队列，从而进入下一个循环。  解析下载下来的网页，将需要的数据解析出来。  数据持久话，保存至数据库中。爬虫的抓取策略在爬虫系统中，...&hellip;</p>
       <div class="post-list__meta"><time datetime="2017-06-13 15:18:24 +0800" class="post-list__meta--date date">2017-06-13</time> &#8226; <span class="post-list__meta--tags tags"></span><a class="btn-border-small" href=/2017/06/python%E7%BC%96%E5%86%99%E7%9F%A5%E4%B9%8E%E7%88%AC%E8%99%AB%E5%AE%9E%E8%B7%B5/>继续阅读</a></div>
   </div>
   
</section>

<section class="post-comments">
  
    <div id="disqus_thread"></div>
    <script>
    
    var disqus_config = function () {
        this.page.url = "http://localhost:4000/2017/09/Node.js%E5%9C%A8CLI%E4%B8%8B%E7%9A%84%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%BD%93%E7%B3%BB%E5%AE%9E%E8%B7%B5-%E6%88%90%E9%83%BDOSC%E6%BA%90%E5%88%9B%E4%BC%9A%E5%88%86%E4%BA%AB%E6%80%BB%E7%BB%93/";
        this.page.identifier = "/2017/09/Node.js%E5%9C%A8CLI%E4%B8%8B%E7%9A%84%E5%B7%A5%E7%A8%8B%E5%8C%96%E4%BD%93%E7%B3%BB%E5%AE%9E%E8%B7%B5-%E6%88%90%E9%83%BDOSC%E6%BA%90%E5%88%9B%E4%BC%9A%E5%88%86%E4%BA%AB%E6%80%BB%E7%BB%93/";
    };

    var disqus_shortname = 'cpselvisblog';
    
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>要查看<a href="http://disqus.com/?ref_noscript"> Disqus </a>评论，请启用 JavaScript</noscript>
    
  
  
  
  
</section>


            <section class="footer">
    <footer>
    	<span class="footer__copyright">本站点采用<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享 署名-非商业性使用-相同方式共享 4.0 国际 许可协议</a></span>
        <span class="footer__copyright">由 <a href="https://jekyllrb.com">Jekyll</a> 于 2017-10-08 生成，感谢 <a href="https://www.digitalocean.com/?refcode=30ed2d146762">Digital Ocean</a> 为本站提供稳定的 VPS 服务</span>
        <span class="footer__copyright">本站由 <a href="https://cpselvis.github.io">@cpselvis</a> 创建，采用 <a href="https://github.com/onevcat/vno-jekyll">Vno - Jekyll</a> 作为主题，您可以在 GitHub 找到<a href="https://github.com/onevcat/OneV-s-Den">本站源码</a> - &copy; 2017</span>
    </footer>
</section>

        </div>
    </div>
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript" src="/js/main.js"></script>



    
  </body>

</html>
